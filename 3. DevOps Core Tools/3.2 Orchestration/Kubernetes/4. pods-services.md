---
title: "â€¢ Pods-Services"
parent: "â€¢ Kubernetes"
grand_parent: 3. DevOps Core Tools
nav_order: 4
has_children: true
---

# Pods & Services

- Pod definition
- ClusterIP, NodePort, LoadBalancer


-----------------------------------


# ğŸŸ¦ **Pods â€“ Init Containers vs Sidecar Containers **

## ğŸ”¹ **What is a Pod? (Theory)**

* Pod is the **smallest deployable unit** in Kubernetes.
* A Pod **can contain one or more containers**.
* All containers inside a pod share:
  âœ” network (same IP)
  âœ” storage volumes
  âœ” lifecycle scope

---

# ğŸŸ© **Init Container (Theory)**

### **Definition**

Init containers are **special containers** that run **before the main container starts**.

### **Key Points**

* Purpose: **prepare the environment** for the main container.
* Runs **sequentially**.
* If an init container **fails**, the pod will not start the main container.
* Used for:
  âœ” config setup
  âœ” environment checks
  âœ” downloading dependencies
  âœ” database checks
  âœ” waiting for external service

### **Real-World Example**

* App should start only after **config.json** is downloaded from S3.
* Init container downloads config â†’ main container runs app.

---

# ğŸŸ¦ **Sidecar Container (Theory)**

### **Definition**

Sidecar is a **helper container** that runs **along with the main container** to add extra functionality.

### **Key Points**

* Runs **parallel** with the main container.
* Used for:
  âœ” log collectors
  âœ” monitoring agents
  âœ” proxy containers (Envoy / Istio)
  âœ” backup agents
  âœ” file sync tasks

### **Real-World Example**

* Main app writes logs â†’ Sidecar container ships logs to Elasticsearch / S3.
* Used heavily in **Service Mesh** (Envoy sidecars).

---

# ğŸŸ© **Init Container Practical Demo**

### **File: init-container.yml**

```yaml
kind: Pod
apiVersion: v1
metadata:
  name: init-test

spec:
  initContainers:
  - name: init-container
    image: busybox:latest
    command: ["sh","-c", "echo 'Initialization started...'; sleep 10; echo 'Initialization completed.'"] 

  containers:
  - name: main-container
    image: busybox:latest
    command: ["sh","-c", "echo 'Main container started'"]
```

### **Commands**

```bash
# Deploy
sudo kubectl apply -f init-container.yml

# Check pod
sudo kubectl get pods

# Check logs
sudo kubectl logs init-test -c init-container
sudo kubectl logs init-test -c main-container

# Watch pod status
sudo watch kubectl get pods

# Delete
sudo kubectl delete -f init-container.yml
```

---

# ğŸŸ¦ **Sidecar Container Practical Demo**

### **File: sidecar-container.yml**

```yaml
kind: Pod
apiVersion: v1
metadata:
  name: sidecar-test

spec:
  volumes:
  - name: shared-logs
    emptyDir: {}

  containers:
  # MAIN: Produces logs
  - name: main-container
    image: busybox
    command: ["sh","-c", "while true; do echo 'Hello Dosto' >> /var/log/app.log; sleep 5; done"]
    volumeMounts:
    - name: shared-logs
      mountPath: /var/log/

  # SIDECAR: Reads logs
  - name: sidecar-container
    image: busybox
    command: ["sh","-c", "tail -f /var/log/app.log"]
    volumeMounts:
    - name: shared-logs
      mountPath: /var/log/
```

### **Commands**

```bash
# Deploy
sudo kubectl apply -f sidecar-container.yml

# Check pods
sudo kubectl get pods

# Logs from main container (no output since it only produces logs)
sudo kubectl logs sidecar-test -c main-container

# Logs from sidecar (continuous output)
sudo kubectl logs sidecar-test -c sidecar-container

# Delete
sudo kubectl delete -f sidecar-container.yml
```

---

# â­ **Real-World Example for Interview (Best Answer)**

### **Init Container Example**

> â€œIn microservices, our app depended on MySQL.
> We used an init container to check database readiness using a loop script.
> Only after MySQL was reachable, the main app container started.
> This avoided startup failures and race conditions.â€

---

### **Sidecar Container Example**

> â€œWe deployed a Node.js app writing logs to /var/log/app.log.
> A sidecar container (FluentBit) shipped logs to Elasticsearch.
> This allowed clean separation:
> App = business logic
> Sidecar = logging/monitoring.â€


